<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ç¤¼ç‰©å°åŠ©æ‰‹ - å®Œæˆ</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script>
  <style>
    body { 
      margin: 0; 
      padding: 0; 
      font-family: 'PingFang SC', 'Microsoft YaHei', sans-serif;
      background: #fff5f8;
    }
    #sketch-container { 
      display: none; 
      margin: 0 auto;
      max-width: 400px;
    }
    #sketch-container.active { 
      display: block; 
    }
    #loading {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(255, 255, 255, 0.8);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 100;
    }
    .spinner {
      width: 50px;
      height: 50px;
      border: 5px solid #f3f3f3;
      border-top: 5px solid #ff69b4;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
  </style>
</head>
<body>
  <div id="loading"><div class="spinner"></div></div>
  <div id="sketch-container"></div>
  
  <script>
    let giftPrice = 0;
    let orderNumber = "";
    let userName = "";
    
    function setup() {
      let canvas = createCanvas(400, 700);
      canvas.parent('sketch-container');
      
      // è·å–è®¢å•ä¿¡æ¯
      giftPrice = parseFloat(localStorage.getItem('selectedGiftPrice')) || 0;
      orderNumber = localStorage.getItem('orderNumber') || "GD" + Math.floor(Math.random() * 1000000000).toString().padStart(9, '0');
      userName = localStorage.getItem('userName') || "äº²çˆ±çš„ç”¨æˆ·";
      
      // éšè—åŠ è½½åŠ¨ç”»
      setTimeout(() => {
        document.getElementById('loading').style.display = 'none';
        document.getElementById('sketch-container').classList.add('active');
      }, 1000);
    }

    function draw() {
      background(255, 245, 250);
      
      // ç»˜åˆ¶é¡¶éƒ¨è£…é¥°
      drawHeader();
      
      // ç»˜åˆ¶ä¸»è¦å†…å®¹
      drawContent();
      
      // ç»˜åˆ¶åº•éƒ¨æŒ‰é’®
      drawFooter();
    }

    function drawHeader() {
      // é¡¶éƒ¨è£…é¥°æ¡
      noStroke();
      fill(255, 105, 180);
      rect(0, 0, width, 10);
      
      // æ ‡é¢˜
      fill(255, 105, 180);
      textSize(24);
      textAlign(CENTER);
      text("è®¢å•å®Œæˆ", width/2, 50);
      
      // ç¤¼ç‰©å›¾æ ‡
      textSize(30);
      text("ğŸ", width/2, 90);
    }

    function drawContent() {
      // æˆåŠŸå›¾æ ‡
      fill(76, 175, 80);
      noStroke();
      ellipse(width/2, 180, 100, 100);
      fill(255);
      textSize(60);
      textAlign(CENTER);
      text("âœ“", width/2, 200);
      
      // æˆåŠŸæ–‡å­—
      fill(255, 105, 180);
      textSize(24);
      text("è®¢å•æ”¯ä»˜æˆåŠŸ!", width/2, 280);
      
      // è®¢å•ä¿¡æ¯
      fill(100);
      textSize(16);
      textAlign(CENTER);
      text(`è®¢å•å·: ${orderNumber}`, width/2, 320);
      text(`æ”¯ä»˜é‡‘é¢: Â¥${giftPrice.toFixed(2)}`, width/2, 350);
      
      // ç¤¼ç‰©ä¿¡æ¯
      fill(255, 105, 180);
      textSize(20);
      text("ğŸ ç¥ç§˜ç¤¼ç‰© ğŸ", width/2, 400);
      fill(100);
      textSize(14);
      text("é¢„è®¡3-5ä¸ªå·¥ä½œæ—¥å†…é€è¾¾", width/2, 430);
      
      // æ„Ÿè°¢ä¿¡æ¯
      fill(70);
      textSize(16);
      textAlign(CENTER);
      text(`æ„Ÿè°¢ ${userName} çš„ä¿¡ä»»`, width/2, 480);
      text("ç¥æ‚¨è´­ç‰©æ„‰å¿«ï¼", width/2, 510);
    }

    function drawFooter() {
      // å®ŒæˆæŒ‰é’®
      drawButton("è¿”å›é¦–é¡µ", 150, height - 120, 100, 50, true);
    }

    function drawButton(label, x, y, w, h, enabled) {
      let hover = enabled && mouseX > x && mouseX < x + w && 
                 mouseY > y && mouseY < y + h;
      
      fill(enabled ? (hover ? color(255, 85, 170) : color(255, 105, 180)) : color(200));
      noStroke();
      rect(x, y, w, h, 25);
      
      fill(255);
      textSize(18);
      textAlign(CENTER);
      text(label, x + w/2, y + h/2 + 8);
    }

    function mousePressed() {
      // æ£€æŸ¥å®ŒæˆæŒ‰é’®ç‚¹å‡»
      if (mouseX > 150 && mouseX < 250 && 
          mouseY > height - 120 && mouseY < height - 70) {
        // æ¸…é™¤è®¢å•ä¿¡æ¯
        localStorage.removeItem('selectedGiftPrice');
        localStorage.removeItem('orderNumber');
        localStorage.removeItem('userName');
        // è¿”å›é¦–é¡µ
        window.location.href = "ask_gift.html";
      }
    }
  </script>
</body>
</html> 